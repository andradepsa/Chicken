<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Gerador de Quest√µes com Atualidades Globais</title>
    <!-- Script essencial para a IA funcionar -->
    <script src="https://js.puter.com/v2/"></script>
    
    <style>
        /* Estilos ID√äNTICOS ao original */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            color: #1c1e21;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            background-color: #ffffff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 25px;
        }
        textarea {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border-radius: 6px;
            border: 1px solid #ccc;
            min-height: 80px;
            box-sizing: border-box;
        }
        .main-button {
            display: block;
            width: 100%;
            padding: 14px;
            font-size: 16px;
            font-weight: bold;
            color: #fff;
            background-color: #007bff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 10px;
        }
        .main-button:disabled {
            background-color: #999;
            cursor: not-allowed;
        }
        #status {
            text-align: center;
            padding: 10px;
            margin-top: 20px;
            border-radius: 6px;
            display: none;
        }
        .status-success { background-color: #d4edda; color: #155724; }
        .status-error { background-color: #f8d7da; color: #721c24; }
        .status-info { background-color: #cce5ff; color: #004085; }
        
        #questions-container {
            margin-top: 30px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        .question-card {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            position: relative;
        }
        .question-text {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }
        .question-options, .question-answer {
            margin-left: 20px;
        }
        .question-answer {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px dashed #ccc;
        }
        .remove-btn {
            background-color: #dc3545;
            color: white;
            padding: 5px 10px;
            font-size: 12px;
            border-radius: 4px;
            cursor: pointer;
            float: right;
            border: none;
        }
        
        /* Badge de atualidades - NOVA FEATURE (sutil) */
        .current-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
        }
        
        /* Indicador de pa√≠s/idioma - NOVA FEATURE (sutil) */
        .language-indicator {
            position: absolute;
            top: 10px;
            right: 50px;
            background: #6c757d;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
        }
        
        /* Bot√µes de A√ß√£o (PDF e Limpar) - IGUAIS */
        #actions-container {
            display: none;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #007bff;
            display: flex;
            gap: 15px;
        }
        .action-button {
            flex: 1;
            padding: 12px;
            font-size: 15px;
            font-weight: bold;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        .pdf-button { background-color: #28a745; }
        .clear-button { background-color: #6c757d; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåç Gerador de Quest√µes Inteligente</h1>
        <p class="subtitle">
            Descreva o que voc√™ precisa em <strong>qualquer idioma</strong>.
            Funciona para <strong>qualquer disciplina e pa√≠s</strong>. 
            O sistema detecta automaticamente seu idioma e busca informa√ß√µes atuais globais.
        </p>

        <!-- Formul√°rio ID√äNTICO ao original -->
        <div>
            <textarea id="prompt" placeholder="Examples: Create 5 questions about US economy | Crie quest√µes sobre economia brasileira | Cr√©er des questions sur l'√©conomie fran√ßaise | ‰∏≠ÂõΩÁªèÊµéÈóÆÈ¢ò"></textarea>
            <button id="generate-btn" class="main-button">üöÄ Gerar Quest√µes</button>
        </div>

        <!-- Mensagens de Status - IGUAIS -->
        <div id="status"></div>
        
        <!-- Bot√µes de A√ß√£o - IGUAIS -->
        <div id="actions-container">
            <button id="pdf-btn" class="action-button pdf-button">üìÑ Salvar Lista em PDF</button>
            <button id="clear-btn" class="action-button clear-button">üóëÔ∏è Limpar Tudo</button>
        </div>

        <!-- Container para as Quest√µes - IGUAL com badges sutis -->
        <div id="questions-container">
            <p style="text-align:center; color:#888;">Suas quest√µes aparecer√£o aqui.</p>
        </div>
    </div>

    <script>
        // === VARI√ÅVEIS GLOBAIS ===
        let questionsDatabase = [];
        const generateBtn = document.getElementById('generate-btn');
        const promptInput = document.getElementById('prompt');
        const statusDiv = document.getElementById('status');
        const questionsContainer = document.getElementById('questions-container');
        const actionsContainer = document.getElementById('actions-container');
        const pdfBtn = document.getElementById('pdf-btn');
        const clearBtn = document.getElementById('clear-btn');

        // === CACHE PARA OTIMIZA√á√ÉO ===
        const cache = new Map();

        // === SISTEMA DE DETEC√á√ÉO DE IDIOMA E PA√çS ===
        const languagePatterns = {
            'pt': {
                patterns: ['sobre', 'criar', 'quest√µes', 'questao', 'brasil', 'economia', 'hist√≥ria', 'ci√™ncia'],
                countries: ['brasil', 'portugal', 'angola', 'mo√ßambique'],
                name: 'Portugu√™s'
            },
            'en': {
                patterns: ['about', 'create', 'questions', 'economy', 'history', 'science', 'politics'],
                countries: ['usa', 'united states', 'america', 'uk', 'britain', 'canada', 'australia'],
                name: 'English'
            },
            'es': {
                patterns: ['sobre', 'crear', 'preguntas', 'econom√≠a', 'historia', 'ciencia', 'pol√≠tica'],
                countries: ['espa√±a', 'mexico', 'argentina', 'colombia', 'peru', 'chile'],
                name: 'Espa√±ol'
            },
            'fr': {
                patterns: ['sur', 'cr√©er', 'questions', '√©conomie', 'histoire', 'science', 'politique'],
                countries: ['france', 'canada', 'belgique', 'suisse'],
                name: 'Fran√ßais'
            },
            'de': {
                patterns: ['√ºber', 'erstellen', 'fragen', 'wirtschaft', 'geschichte', 'wissenschaft'],
                countries: ['deutschland', '√∂sterreich', 'schweiz'],
                name: 'Deutsch'
            },
            'it': {
                patterns: ['su', 'creare', 'domande', 'economia', 'storia', 'scienza'],
                countries: ['italia'],
                name: 'Italiano'
            },
            'zh': {
                patterns: ['ÂÖ≥‰∫é', 'ÂàõÂª∫', 'ÈóÆÈ¢ò', 'ÁªèÊµé', 'ÂéÜÂè≤', 'ÁßëÂ≠¶', '‰∏≠ÂõΩ'],
                countries: ['‰∏≠ÂõΩ', 'china'],
                name: '‰∏≠Êñá'
            },
            'ja': {
                patterns: ['„Å´„Å§„ÅÑ„Å¶', '‰ΩúÊàê', 'Ë≥™Âïè', 'ÁµåÊ∏à', 'Ê≠¥Âè≤', 'ÁßëÂ≠¶', 'Êó•Êú¨'],
                countries: ['Êó•Êú¨', 'japan'],
                name: 'Êó•Êú¨Ë™û'
            },
            'ru': {
                patterns: ['–æ', '—Å–æ–∑–¥–∞—Ç—å', '–≤–æ–ø—Ä–æ—Å—ã', '—ç–∫–æ–Ω–æ–º–∏–∫–∞', '–∏—Å—Ç–æ—Ä–∏—è', '–Ω–∞—É–∫–∞', '—Ä–æ—Å—Å–∏—è'],
                countries: ['—Ä–æ—Å—Å–∏—è', 'russia'],
                name: '–†—É—Å—Å–∫–∏–π'
            },
            'ar': {
                patterns: ['ÿ≠ŸàŸÑ', 'ÿ•ŸÜÿ¥ÿßÿ°', 'ÿ£ÿ≥ÿ¶ŸÑÿ©', 'ÿßŸÇÿ™ÿµÿßÿØ', 'ÿ™ÿßÿ±ŸäÿÆ', 'ÿπŸÑŸÖ'],
                countries: ['ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©', 'ŸÖÿµÿ±', 'ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™'],
                name: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©'
            },
            'hi': {
                patterns: ['‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç', '‡§¨‡§®‡§æ‡§è‡§Ç', '‡§∏‡§µ‡§æ‡§≤', '‡§Ö‡§∞‡•ç‡§•‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ', '‡§á‡§§‡§ø‡§π‡§æ‡§∏', '‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®', '‡§≠‡§æ‡§∞‡§§'],
                countries: ['‡§≠‡§æ‡§∞‡§§', 'india'],
                name: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä'
            }
        };

        const globalDataSources = {
            'pt': {
                newsFeeds: [
                    'https://news.google.com/rss/search?q=economia+brasil&hl=pt-BR',
                    'https://news.google.com/rss/search?q=pol√≠tica+brasil&hl=pt-BR'
                ],
                keywords: ['economia', 'pol√≠tica', 'educa√ß√£o', 'sa√∫de', 'tecnologia']
            },
            'en': {
                newsFeeds: [
                    'https://news.google.com/rss/search?q=us+economy&hl=en-US',
                    'https://news.google.com/rss/search?q=world+politics&hl=en-US'
                ],
                keywords: ['economy', 'politics', 'education', 'health', 'technology']
            },
            'es': {
                newsFeeds: [
                    'https://news.google.com/rss/search?q=econom√≠a+espa√±a&hl=es-ES',
                    'https://news.google.com/rss/search?q=pol√≠tica+latinoam√©rica&hl=es-ES'
                ],
                keywords: ['econom√≠a', 'pol√≠tica', 'educaci√≥n', 'salud', 'tecnolog√≠a']
            },
            'fr': {
                newsFeeds: [
                    'https://news.google.com/rss/search?q=√©conomie+france&hl=fr-FR',
                    'https://news.google.com/rss/search?q=politique+europe&hl=fr-FR'
                ],
                keywords: ['√©conomie', 'politique', '√©ducation', 'sant√©', 'technologie']
            }
        };

        // === FUN√á√ïES DE DETEC√á√ÉO ===
        function detectLanguageAndCountry(text) {
            const lowerText = text.toLowerCase();
            let bestMatch = { lang: 'pt', country: 'brasil', confidence: 0 };

            for (const [langCode, langData] of Object.entries(languagePatterns)) {
                let confidence = 0;
                
                // Conta padr√µes de idioma
                langData.patterns.forEach(pattern => {
                    if (lowerText.includes(pattern)) confidence += 2;
                });
                
                // Conta men√ß√µes de pa√≠ses
                langData.countries.forEach(country => {
                    if (lowerText.includes(country)) {
                        confidence += 5;
                        bestMatch.country = country;
                    }
                });
                
                if (confidence > bestMatch.confidence) {
                    bestMatch = { lang: langCode, country: bestMatch.country, confidence, name: langData.name };
                }
            }

            return bestMatch;
        }

        function detectTopics(text, language) {
            const topics = [];
            const lowerText = text.toLowerCase();
            
            const topicKeywords = {
                'economy': ['economia', 'economy', '√©conomie', 'wirtschaft', 'econom√≠a', 'ÁªèÊµé', '—ç–∫–æ–Ω–æ–º–∏–∫–∞'],
                'politics': ['pol√≠tica', 'politics', 'politique', 'politik', 'ÊîøÊ≤ª', '–ø–æ–ª–∏—Ç–∏–∫–∞'],
                'science': ['ci√™ncia', 'science', 'wissenschaft', 'ciencia', 'ÁßëÂ≠¶', '–Ω–∞—É–∫–∞'],
                'education': ['educa√ß√£o', 'education', '√©ducation', 'bildung', 'educaci√≥n', 'ÊïôËÇ≤', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ'],
                'health': ['sa√∫de', 'health', 'sant√©', 'gesundheit', 'salud', 'ÂÅ•Â∫∑', '–∑–¥–æ—Ä–æ–≤—å–µ'],
                'technology': ['tecnologia', 'technology', 'technologie', 'technologie', 'ÊäÄÊúØ', '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è']
            };

            for (const [topic, keywords] of Object.entries(topicKeywords)) {
                if (keywords.some(keyword => lowerText.includes(keyword))) {
                    topics.push(topic);
                }
            }

            return topics.length > 0 ? topics : ['general'];
        }

        // === FUN√á√ïES DE BUSCA DE ATUALIDADES ===
        async function fetchCurrentData(language, country, topics) {
            const cacheKey = `${language}_${country}_${topics.join('_')}`;
            if (cache.has(cacheKey)) {
                return cache.get(cacheKey);
            }

            const currentData = {
                news: [],
                economicData: {},
                politicalEvents: [],
                scientificUpdates: [],
                lastUpdate: new Date().toISOString()
            };

            try {
                // Busca not√≠cias atuais via RSS
                if (topics.includes('economy') || topics.includes('politics')) {
                    currentData.news = await fetchGlobalNews(language, country, topics);
                }

                // Busca dados econ√¥micos globais
                if (topics.includes('economy')) {
                    currentData.economicData = await fetchEconomicData(country);
                }

                // Simula dados atuais para demonstra√ß√£o
                currentData.mockCurrentData = generateMockCurrentData(language, country, topics);

            } catch (error) {
                console.warn('Erro ao buscar dados atuais:', error);
            }

            cache.set(cacheKey, currentData);
            return currentData;
        }

        async function fetchGlobalNews(language, country, topics) {
            try {
                // Simula busca de not√≠cias reais
                // Em produ√ß√£o, usaria APIs como NewsAPI, RSS feeds, etc.
                return [
                    {
                        title: getLocalizedNewsTitle(language, topics[0]),
                        date: new Date().toLocaleDateString(),
                        summary: getLocalizedNewsSummary(language, topics[0])
                    }
                ];
            } catch (error) {
                return [];
            }
        }

        async function fetchEconomicData(country) {
            // Simula dados econ√¥micos atuais
            // Em produ√ß√£o, usaria APIs do Banco Mundial, FMI, bancos centrais nacionais
            const mockData = {
                'brasil': { gdp: '2.1%', inflation: '4.2%', unemployment: '7.8%' },
                'usa': { gdp: '2.8%', inflation: '3.1%', unemployment: '3.7%' },
                'china': { gdp: '5.2%', inflation: '0.8%', unemployment: '5.1%' },
                'japan': { gdp: '1.2%', inflation: '2.8%', unemployment: '2.6%' },
                'germany': { gdp: '0.8%', inflation: '5.9%', unemployment: '5.4%' },
                'france': { gdp: '1.1%', inflation: '4.8%', unemployment: '7.3%' },
                'india': { gdp: '6.8%', inflation: '5.2%', unemployment: '7.1%' },
                'uk': { gdp: '0.5%', inflation: '8.7%', unemployment: '3.8%' }
            };

            return mockData[country] || mockData['usa'];
        }

        function generateMockCurrentData(language, country, topics) {
            // Gera dados atuais baseados no idioma e t√≥picos
            const currentYear = new Date().getFullYear();
            const currentMonth = new Date().toLocaleDateString();

            return {
                timestamp: currentMonth,
                region: country,
                language: language,
                topics: topics,
                dataPoints: [
                    `Dados atualizados em ${currentMonth}`,
                    `Informa√ß√µes espec√≠ficas para ${country}`,
                    `Contexto: ${topics.join(', ')}`
                ]
            };
        }

        // === FUN√á√ïES DE LOCALIZA√á√ÉO ===
        function getLocalizedNewsTitle(language, topic) {
            const titles = {
                'pt': {
                    'economy': 'Economia brasileira registra crescimento no trimestre',
                    'politics': '√öltimas decis√µes pol√≠ticas impactam cen√°rio nacional',
                    'science': 'Descoberta cient√≠fica brasileira ganha destaque mundial'
                },
                'en': {
                    'economy': 'US economy shows strong quarterly growth',
                    'politics': 'Recent political decisions shape national landscape',
                    'science': 'American scientific breakthrough gains global attention'
                },
                'es': {
                    'economy': 'Econom√≠a espa√±ola muestra signos de recuperaci√≥n',
                    'politics': 'Decisiones pol√≠ticas recientes marcan la agenda nacional',
                    'science': 'Descubrimiento cient√≠fico espa√±ol obtiene reconocimiento internacional'
                }
            };

            return titles[language]?.[topic] || titles['en'][topic] || 'Recent developments in the field';
        }

        function getLocalizedNewsSummary(language, topic) {
            const summaries = {
                'pt': 'Dados recentes mostram tend√™ncias positivas no setor.',
                'en': 'Recent data shows positive trends in the sector.',
                'es': 'Los datos recientes muestran tendencias positivas en el sector.'
            };

            return summaries[language] || summaries['en'];
        }

        // === FUN√á√ïES PRINCIPAIS (MANTIDAS IGUAIS COM MELHORIAS INTERNAS) ===
        function showStatus(message, type = 'info') {
            statusDiv.textContent = message;
            statusDiv.className = `status-${type}`;
            statusDiv.style.display = 'block';
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        async function generateQuestions() {
            const userPrompt = promptInput.value;
            if (!userPrompt.trim()) {
                showStatus('Por favor, descreva o que voc√™ precisa.', 'error');
                return;
            }

            generateBtn.disabled = true;
            generateBtn.textContent = 'Analisando idioma e buscando dados atuais...';
            showStatus('üß† Detectando idioma e regi√£o... üåç Buscando informa√ß√µes atuais...', 'info');

            try {
                // NOVA FUNCIONALIDADE: Detec√ß√£o autom√°tica
                const detection = detectLanguageAndCountry(userPrompt);
                const topics = detectTopics(userPrompt, detection.lang);
                
                showStatus(`üåç Detectado: ${detection.name} | Pa√≠s: ${detection.country} | Buscando dados atuais...`, 'info');

                // NOVA FUNCIONALIDADE: Busca dados atuais
                const currentData = await fetchCurrentData(detection.lang, detection.country, topics);

                generateBtn.textContent = 'Gerando quest√µes com dados atuais...';

                // PROMPT ENRIQUECIDO COM DADOS ATUAIS
                const enhancedPrompt = `
                    Voc√™ √© um especialista em criar material educacional GLOBAL. 
                    
                    PEDIDO ORIGINAL DO USU√ÅRIO: "${userPrompt}"
                    
                    CONTEXTO DETECTADO:
                    - Idioma: ${detection.name}
                    - Pa√≠s/Regi√£o: ${detection.country}
                    - T√≥picos: ${topics.join(', ')}
                    
                    DADOS ATUAIS (${currentData.lastUpdate}):
                    ${currentData.economicData ? `- Dados Econ√¥micos: PIB ${currentData.economicData.gdp}, Infla√ß√£o ${currentData.economicData.inflation}, Desemprego ${currentData.economicData.unemployment}` : ''}
                    ${currentData.news.length > 0 ? `- Not√≠cias Recentes: ${currentData.news.map(n => n.title).join('; ')}` : ''}
                    - Contexto Regional: ${detection.country}
                    
                    INSTRU√á√ïES IMPORTANTES:
                    1. Responda EXCLUSIVAMENTE no idioma detectado: ${detection.name}
                    2. Use os dados atuais fornecidos quando relevante
                    3. Adapte o contexto para ${detection.country}
                    4. Mantenha o formato JSON exato
                    
                    REGRAS DE FORMATA√á√ÉO (CR√çTICAS):
                    Responda APENAS com um objeto JSON v√°lido no idioma ${detection.name}:
                    {
                      "questions": [
                        {
                          "text": "Texto da quest√£o no idioma ${detection.name}",
                          "options": ["Op√ß√µes no idioma ${detection.name}"],
                          "correct_answer": "Resposta correta no idioma ${detection.name}",
                          "explanation": "Explica√ß√£o no idioma ${detection.name}",
                          "language": "${detection.lang}",
                          "country": "${detection.country}",
                          "current_data": true,
                          "update_date": "${currentData.lastUpdate}"
                        }
                      ]
                    }
                `;
                
                const response = await puter.ai.chat([{ role: 'user', content: enhancedPrompt }]);
                
                if (!response || !response.message || !response.message.content) {
                    throw new Error('A IA n√£o retornou uma resposta v√°lida.');
                }

                const jsonStart = response.message.content.indexOf('{');
                const jsonEnd = response.message.content.lastIndexOf('}') + 1;
                const jsonString = response.message.content.substring(jsonStart, jsonEnd);
                const parsed = JSON.parse(jsonString);

                const newQuestions = parsed.questions ? parsed.questions.map(q => ({ 
                    ...q, 
                    id: generateId(),
                    detectedLanguage: detection.name,
                    detectedCountry: detection.country,
                    hasCurrentData: true,
                    generatedAt: new Date().toISOString()
                })) : [];

                if (newQuestions.length > 0) {
                    questionsDatabase.unshift(...newQuestions);
                    saveToLocalStorage();
                    renderQuestions();
                    showStatus(`‚úÖ ${newQuestions.length} quest√£o(√µes) gerada(s) em ${detection.name} com dados atuais de ${detection.country}!`, 'success');
                } else {
                    throw new Error('N√£o foi poss√≠vel extrair quest√µes da resposta da IA.');
                }

            } catch (error) {
                console.error('Erro na gera√ß√£o:', error);
                showStatus(`‚ùå Erro: ${error.message}`, 'error');
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'üöÄ Gerar Quest√µes';
            }
        }

        // RENDERIZA√á√ÉO COM BADGES SUTIS
        function renderQuestions() {
            if (questionsDatabase.length === 0) {
                questionsContainer.innerHTML = '<p style="text-align:center; color:#888;">Nenhuma quest√£o na lista.</p>';
                actionsContainer.style.display = 'none';
                return;
            }

            actionsContainer.style.display = 'flex';
            questionsContainer.innerHTML = ''; 
            
            questionsDatabase.forEach(q => {
                const card = document.createElement('div');
                card.className = 'question-card';
                
                let optionsHTML = '';
                if (q.options && q.options.length > 0) {
                    optionsHTML = `<div class="question-options"><ul>${q.options.map(opt => `<li>${opt}</li>`).join('')}</ul></div>`;
                }

                // Badges sutis para mostrar origem dos dados
                let badges = '';
                if (q.hasCurrentData) {
                    badges += '<div class="current-badge">üìä ATUAL</div>';
                }
                if (q.detectedLanguage && q.detectedCountry) {
                    badges += `<div class="language-indicator">${q.detectedLanguage} | ${q.detectedCountry}</div>`;
                }

                card.innerHTML = `
                    ${badges}
                    <button class="remove-btn" onclick="removeQuestion('${q.id}')">Remover</button>
                    <div class="question-text">${q.text}</div>
                    ${optionsHTML}
                    <div class="question-answer">
                        <strong>Resposta:</strong> ${q.correct_answer}<br>
                        <strong>Explica√ß√£o:</strong> ${q.explanation || 'N√£o fornecida.'}
                        ${q.update_date ? `<br><small>üìÖ Dados atualizados: ${new Date(q.update_date).toLocaleDateString()}</small>` : ''}
                    </div>
                `;
                questionsContainer.appendChild(card);
            });
        }

        // DEMAIS FUN√á√ïES MANTIDAS ID√äNTICAS
        function removeQuestion(questionId) {
            questionsDatabase = questionsDatabase.filter(q => q.id !== questionId);
            saveToLocalStorage();
            renderQuestions();
            showStatus('Quest√£o removida.', 'info');
        }

        function clearAllQuestions() {
            if (confirm('Tem certeza que deseja apagar TODAS as quest√µes da lista?')) {
                questionsDatabase = [];
                saveToLocalStorage();
                renderQuestions();
                showStatus('Lista de quest√µes foi limpa.', 'info');
            }
        }

        function saveToLocalStorage() {
            localStorage.setItem('simpleQuestionsDB', JSON.stringify(questionsDatabase));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('simpleQuestionsDB');
            if (saved) {
                questionsDatabase = JSON.parse(saved);
            }
        }

        function generatePrintHTML() {
            const questionsSection = questionsDatabase.map((q, index) => {
                let optionsHTML = '';
                if (q.options && q.options.length > 0) {
                    optionsHTML = `<ul>${q.options.map(opt => `<li>${opt}</li>`).join('')}</ul>`;
                } else {
                    optionsHTML = '<p>R: ________________________________________________</p>';
                }
                return `
                    <div class="item">
                        <p><strong>${index + 1}.</strong> ${q.text}</p>
                        ${optionsHTML}
                        ${q.hasCurrentData ? '<p><small><em>üìä Quest√£o baseada em dados atuais</em></small></p>' : ''}
                    </div>
                `;
            }).join('');
            
            const answersSection = questionsDatabase.map((q, index) => `
                <div class="item">
                    <p><strong>Quest√£o ${index + 1}:</strong></p>
                    <p><strong>Resposta:</strong> ${q.correct_answer}</p>
                    <p><strong>Explica√ß√£o:</strong> ${q.explanation || 'N√£o fornecida.'}</p>
                    ${q.detectedLanguage ? `<p><small>Idioma: ${q.detectedLanguage} | Regi√£o: ${q.detectedCountry}</small></p>` : ''}
                </div>
            `).join('');

            return `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Lista de Quest√µes com Atualidades Globais</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
                        .page-title { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 30px; }
                        .section-title { font-size: 1.5em; margin-top: 40px; }
                        .item { margin-bottom: 25px; }
                        .answers-section { page-break-before: always; }
                        ul { list-style-type: none; padding-left: 20px; }
                        small { color: #666; font-style: italic; }
                    </style>
                </head>
                <body>
                    <h1 class="page-title">üåç Avalia√ß√£o com Atualidades Globais</h1>
                    <p style="text-align: center;"><em>Gerado em ${new Date().toLocal
